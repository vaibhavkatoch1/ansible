---
- name: test book
  hosts: ansible_demo
  become: true
  vars:
          mysql_root_password: "vaibhav.12"
          mysql_db: "wordpress"
          mysql_password: "vaibhav.12"
          mysql_user: "vaibhav"

  tasks:         
          - name: Download and unpack latest WordPress
            unarchive:
                    src: https://wordpress.org/latest.zip
                    dest: "/var/www/html/"
                    remote_src: yes
                    creates: "/var/www/html/wordpress"
            tags: [ wordpress ]

          - name: Set ownership
            file:
                   path: "/var/www/html/"
                   state: directory
                   recurse: yes
                   owner: www-data
                   group: www-data
            tags: [ wordpress ]

          - name: Set permissions for directories
            shell: "/usr/bin/find /var/www/html/wordpress/ -type d -exec chmod 750 {} \\;"
            tags: [ wordpress ]

          - name: Set permissions for files
            shell: "/usr/bin/find /var/www/html/wordpress/ -type f -exec chmod 640 {} \\;"
            tags: [ wordpress ]

          #- name: Set up wp-config
           # template:
            #  src: "files/wp-config.php.j2"
             # dest: "/var/www/html/wordpress/wp-config.php"
            #tags: [ wordpress ]
          - name: Restart Apache
            service:
              name: apache2
              state: restarted
  handlers:
          - name: Reload Apache
            service:
              name: apache2
              state: reloaded

          #- name: Restart Apache
          #  service:
          #    name: apache2
          #    state: restarted